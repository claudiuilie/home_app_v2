<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
<h:head>
    <title>Cinema</title>
    <h:outputStylesheet library="css" name="carousel.css"/>
</h:head>

<body>
<!--    <div class="container">-->
<ui:insert name="content">
    <ui:include src="templates/content.xhtml"/>
</ui:insert>

<div class="card text-center">
    <div class="card-header">
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" id="search-tab" data-toggle="tab" href="#search" role="tab" aria-controls="search" aria-selected="true">Search</a>
            </li>
            <li class="nav-item">
                    <a class="nav-link" id="watchlist-tab" data-toggle="tab" href="#watchlist" role="tab" aria-controls="watchlist" aria-selected="false" onclick="refreshWatchlist()">Watchlist</a>
            </li>
        </ul>
    </div>
    <div class="card-body">
        <div class="tab-content">
            <div class="tab-pane active" id="search" role="tabpanel" aria-labelledby="search-tab">
                <div class="container mb-5">
                    <h:form>
                        <div class="form-group">
                            <label class="text-info" style="color: #1c7430">Search:</label>
                            <h:inputText value="#{searchMovies.input}" required="true" styleClass="form-control"/>
                        </div>
                        <h:commandButton value="Sugeeee-o" action="#{searchMovies.searchMovies}" styleClass="btn btn-primary btn-lg btn-block"/>
                    </h:form>
                </div>
                <section class="page-section portfolio">
                    <h:panelGroup layout="block" styleClass="container-md" rendered="#{searchMovies.movieList.size() == 0 and searchMovies.input != null}">
                        <div class="alert alert-warning alert-dismissible fade show text-center" role="alert">
                            No results.
                            <button type="button" class="close text-danger" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">x</span>
                            </button>
                        </div>
                    </h:panelGroup>
                    <h:panelGroup layout="block" rendered ="#{searchMovies.movieList.size() != 0 }" styleClass="container">
                        <h:panelGroup layout="block" styleClass="card mb">
                            <h:graphicImage value="#{searchMovies.movieThumbnail}" alt="No image" styleClass="card-img-top border"/>
                            <div class="p-2" style="background: #cecece">
                                <h3>
                                    <a href="#{searchMovies.movieLink}" class="badge badge-warning float-right" target="_blank">
                                        <strong>IMDb</strong>
                                    </a>
                                </h3>
                                <div class="ratings float-left">
                                    <div class="empty-stars"></div>
                                    <div class="full-stars" style="width:70%"></div>
                                </div>
                            </div>
                            <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                                <ol class="carousel-indicators search-indicators" style="margin-bottom:250px;">
                                </ol>
                                <div class="carousel-inner">
                                    <ui:repeat value="#{searchMovies.movieList}" var="m" >
                                        <div class="carousel-item searchlist-item" >
                                            <div class="card-body">
                                                <h3 class="text-center">#{m.title}</h3>
                                            </div>
                                            <ul class="list-group list-group-flush ">
                                            <li class="list-group-item text-center">
                                            <span class="badge badge-secondary">Seeds:
                                              <span class="badge badge-validator">${m.seeders}</span>
                                            </span>
                                                <span class="badge badge-secondary">Peers:
                                              <span class="badge badge-validator">${m.peers}</span>
                                            </span>
                                                <span class="badge badge-secondary">Size:
                                              <span class="badge badge-info">${m.size}</span>
                                            </span>
                                                <span class="badge badge-secondary">Uploaded:
                                              <span class="badge badge-info">${m.upload_date}</span>
                                            </span>
                                            </li>
                                        </ul>
                                                <div class="p-2">
                                                    <h:form>
                                                        <h:commandButton type="button" styleClass="btn btn-block #{m.on_watchlist ? 'btn-success' : 'btn-outline-warning'}" value="#{m.on_watchlist ? 'Added to Watchlist' : 'Add to Watchlist'}" disabled="#{m.on_watchlist}"/>
                                                        <f:ajax event="click" listener="#{m.addToWatchlist()}" render="@this"/>
                                                    </h:form>
                                                </div>
                                        </div>
                                    </ui:repeat>
                                </div>
                                <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                                    <span class="carousel-control-prev-icon" aria-hidden="true"/>
                                    <span class="sr-only">Previous</span>
                                </a>
                                <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                                    <span class="carousel-control-next-icon" aria-hidden="true"/>
                                    <span class="sr-only">Next</span>
                                </a>
                            </div>
                        </h:panelGroup>
                    </h:panelGroup>
                </section>
            </div>
            <div class="tab-pane" id="watchlist" role="tabpanel" aria-labelledby="watchlist-tab">
                <section class="page-section portfolio">
                    <div class="container-md">
                        <div class="card mb">
                            <div id="carouselExampleIndicators2" class="carousel slide" data-ride="carousel">
                                <div class="carousel-item watchlist-item active">
                                    <img class="d-block w-100" src="..." alt="First slide"/>
                                </div>
                                <ol class="carousel-indicators watchlist-indicators" style="margin-bottom:250px;">
                                </ol>
                                <div class="carousel-inner">
                                    <ui:repeat value="#{watchlist.watchList}" var="w">
                                        <div class="carousel-item watchlist-item">
                                            <img class="d-block w-100" src="#{w.thumbnail}" alt="First slide"/>
                                            <div class="card-body">
                                                <h3 class="text-center">#{w.title}</h3>
                                            </div>
                                            <ul class="list-group list-group-flush ">
                                                <li class="list-group-item text-center">
                                            <span class="badge badge-secondary">Seeds:
                                              <span class="badge badge-validator">${w.seeders}</span>
                                            </span>
                                                    <span class="badge badge-secondary">Peers:
                                              <span class="badge badge-validator">${w.peers}</span>
                                            </span>
                                                    <span class="badge badge-secondary">Size:
                                              <span class="badge badge-info">${w.size}</span>
                                            </span>
                                                    <span class="badge badge-secondary">Uploaded:
                                              <span class="badge badge-info">${w.upload_date}</span>
                                            </span>
                                                </li>
                                            </ul>
                                        </div>
                                    </ui:repeat>
                                </div>
                                <a class="carousel-control-prev" href="#carouselExampleIndicators2" role="button" data-slide="prev">
                                    <span class="carousel-control-prev-icon" aria-hidden="true"/>
                                    <span class="sr-only">Previous</span>
                                </a>
                                <a class="carousel-control-next" href="#carouselExampleIndicators2" role="button" data-slide="next">
                                    <span class="carousel-control-next-icon" aria-hidden="true"/>
                                    <span class="sr-only">Next</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>
    <div class="card-footer">
        ...
    </div>
</div>


<h:outputScript library="js" name="carousel.js"/>
</body>

</html>

